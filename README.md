# Cat-Message v2.0 - 加密聊天工具

## 新功能

### 多种加密模式选择
- **无加密模式**：兼容模式，快速连接，无加密保护
- **RSA2048**：快速模式，较高安全性，连接速度快
- **RSA4096**：标准模式，高安全性，平衡速度和安全
- **RSA8192**：高安全模式，最高安全性，连接较慢

### RSA加密通信
- 在连接服务器时自动交换RSA密钥
- 所有消息通信都经过RSA加密保护（加密模式下）
- 确保聊天内容的安全性

### 图片和文件分享
- 图片不再使用base64编码传输
- 服务器端使用UUID存储图片和文件
- 客户端通过HTTP请求获取文件
- 支持任意类型文件发送
- 文件大小限制可在config.ini中配置（默认无限制）
- 文件自动保留原始文件名
- **文件拖拽功能**：接收的文件自动下载到本地，可直接从聊天界面拖拽到文件管理器
- **一键打开文件夹**：双击可直接打开文件所在文件夹
- **缓存管理**：菜单栏提供"清理缓存"功能，可一键清理所有下载的文件
- 提高传输效率和存储管理

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 启动服务器
```bash
python src/server.py
```

服务器会启动两个服务：
- 端口12345：聊天服务
- 端口12346：图片和文件服务

### 启动客户端
```bash
python src/user.py
```

在连接界面选择合适的加密模式：
- 对于快速测试或本地网络，可选择"无加密"
- 对于普通使用，推荐选择"RSA4096"
- 对于高安全需求，选择"RSA8192"

## 端口说明

确保服务器开放以下端口：
- **12345**：主要聊天通信端口
- **12346**：图片和文件传输HTTP服务端口

## 安全特性

1. **多级加密选择**：根据需要选择不同的加密强度
2. **密钥交换**：客户端与服务器安全交换公钥（加密模式下）
3. **图片安全**：图片通过UUID访问，避免直接路径暴露
4. **向后兼容**：支持无加密模式，兼容旧版本

## 加密模式说明

| 模式 | 密钥长度 | 安全级别 | 连接速度 | 适用场景 |
|------|----------|----------|----------|----------|
| 无加密 | - | 无 | 最快 | 本地测试、内网环境 |
| RSA2048 | 2048位 | 中 | 快 | 一般聊天需求 |
| RSA4096 | 4096位 | 高 | 中等 | 推荐日常使用 |
| RSA8192 | 8192位 | 最高 | 慢 | 高安全需求 |

## 文件说明

- `src/server.py`：服务器端程序
- `src/user.py`：客户端程序
- `image_storage/`：服务器图片存储目录（自动创建）
- `file_storage/`：服务器文件存储目录（自动创建）
- `chat.json`：聊天记录文件
- `server.log`：服务器日志文件
- `config.ini`：服务器配置文件
- `docs/`：详细文档目录

## 注意事项

1. 图片和文件会永久保存在服务器的相应存储目录中
2. 文件大小限制默认关闭，可在config.ini中配置启用
3. 高位数密钥（RSA8192）首次连接可能需要较长时间生成密钥对
4. 确保客户端和服务器版本一致
5. 建议在防火墙中开放所需端口
6. 不同加密模式的客户端可以同时连接到同一服务器
7. **文件功能**：接收的文件自动下载到系统临时目录，可拖拽使用
8. **文件管理**：双击文件夹路径可直接打开文件所在位置

## 详细文档

更多配置和使用说明请查看：[📚 文档中心](docs/README.md)

- [配置说明](docs/configuration.md) - config.ini 详细配置指南
- [文件分享功能](docs/file-sharing.md) - 文件发送和下载功能详解

**详细说明请阅读[文档](https://cat-cat-studio.github.io/cat-message/)**
